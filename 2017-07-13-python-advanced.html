<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="NingAnMe, Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="内容 什么是函数式编程 Python的函数式编程特点 Python的模块 Python面向对象编程 Python强大的定制类  python函数式编程不是纯函数式变成 : 允许有变量 支持高阶函数 : 函数也可以作为变量传入 支持闭包 : 有了闭包就能返回函数 有限度地支持匿名函数 高阶函数变量可以指向高阶函数 函数的参数可以接收变量 一个函数可以接收另一个函数作为参数 能够接收函数作参数的函数就">
<meta property="og:type" content="article">
<meta property="og:title" content="Python 进阶">
<meta property="og:url" content="http://ninganme.github.io/2017-07-13-python-advanced.html">
<meta property="og:site_name" content="NingAnMe">
<meta property="og:description" content="内容 什么是函数式编程 Python的函数式编程特点 Python的模块 Python面向对象编程 Python强大的定制类  python函数式编程不是纯函数式变成 : 允许有变量 支持高阶函数 : 函数也可以作为变量传入 支持闭包 : 有了闭包就能返回函数 有限度地支持匿名函数 高阶函数变量可以指向高阶函数 函数的参数可以接收变量 一个函数可以接收另一个函数作为参数 能够接收函数作参数的函数就">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2017-08-12T04:58:08.350Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Python 进阶">
<meta name="twitter:description" content="内容 什么是函数式编程 Python的函数式编程特点 Python的模块 Python面向对象编程 Python强大的定制类  python函数式编程不是纯函数式变成 : 允许有变量 支持高阶函数 : 函数也可以作为变量传入 支持闭包 : 有了闭包就能返回函数 有限度地支持匿名函数 高阶函数变量可以指向高阶函数 函数的参数可以接收变量 一个函数可以接收另一个函数作为参数 能够接收函数作参数的函数就">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"always","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":50},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://ninganme.github.io/2017-07-13-python-advanced.html"/>





  <title>Python 进阶 | NingAnMe</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">NingAnMe</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            时间轴
          </a>
        </li>
      
        
        <li class="menu-item menu-item-github">
          <a href="https://github.com/ninganme" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-github"></i> <br />
            
            GitHub
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://ninganme.github.io/2017-07-13-python-advanced.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="NingAnMe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NingAnMe">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Python 进阶</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-13T10:54:55+08:00">
                2017-07-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="内容"><a href="#内容" class="headerlink" title="内容"></a>内容</h2><ol>
<li>什么是函数式编程</li>
<li>Python的函数式编程特点</li>
<li>Python的模块</li>
<li>Python面向对象编程</li>
<li>Python强大的定制类</li>
</ol>
<h2 id="python函数式编程"><a href="#python函数式编程" class="headerlink" title="python函数式编程"></a>python函数式编程</h2><p>不是纯函数式变成 : 允许有变量</p>
<p>支持高阶函数 : 函数也可以作为变量传入</p>
<p>支持闭包 : 有了闭包就能返回函数</p>
<p>有限度地支持匿名函数</p>
<h3 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h3><p>变量可以指向高阶函数</p>
<p>函数的参数可以接收变量</p>
<p>一个函数可以接收另一个函数作为参数</p>
<p>能够接收函数作参数的函数就是高阶函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(x,y,f)</span>:</span></div><div class="line">    <span class="keyword">return</span> f(x) + f(y)</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>add(<span class="number">-5</span>,<span class="number">9</span>,ads)</div><div class="line"><span class="number">14</span></div></pre></td></tr></table></figure>
<h2 id="Python-中的高阶函数"><a href="#Python-中的高阶函数" class="headerlink" title="Python 中的高阶函数"></a>Python 中的高阶函数</h2><p>Python 中有很多实用的高阶函数</p>
<h3 id="map-函数"><a href="#map-函数" class="headerlink" title="map()函数"></a>map()函数</h3><p>map()是 Python 内置的高阶函数，它接收一个函数 f 和一个 list，并通过把函数 f 依次作用在 list 的每个元素上，得到一个新的 list 并返回。也就是说map()并不改变原来的 list</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x)</span>:</span></div><div class="line">    <span class="keyword">return</span> x*x</div><div class="line"><span class="keyword">print</span> map(f, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</div><div class="line"></div><div class="line"><span class="comment"># 输出结果</span></div><div class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">25</span>, <span class="number">36</span>, <span class="number">49</span>, <span class="number">64</span>, <span class="number">81</span>]</div></pre></td></tr></table></figure>
<h3 id="reduce-函数"><a href="#reduce-函数" class="headerlink" title="reduce() 函数"></a>reduce() 函数</h3><p>reduce()函数接收的参数和 map()类似，一个函数 f，一个list，但行为和 map()不同，reduce()传入的函数 f 必须接收两个参数，reduce()对list的每个元素反复调用函数f，并返回最终结果值。reduce()还可以接收第3个可选参数，作为计算的初始值,第一轮结算会变成第一个元素和初始值之间</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x, y)</span>:</span></div><div class="line">    <span class="keyword">return</span> x + y</div><div class="line"></div><div class="line"><span class="comment"># 调用 reduce(f, [1, 3, 5, 7, 9])时，reduce函数将做如下计算：</span></div><div class="line"></div><div class="line">先计算头两个元素：f(<span class="number">1</span>, <span class="number">3</span>)，结果为<span class="number">4</span>；</div><div class="line">再把结果和第<span class="number">3</span>个元素计算：f(<span class="number">4</span>, <span class="number">5</span>)，结果为<span class="number">9</span>；</div><div class="line">再把结果和第<span class="number">4</span>个元素计算：f(<span class="number">9</span>, <span class="number">7</span>)，结果为<span class="number">16</span>；</div><div class="line">再把结果和第<span class="number">5</span>个元素计算：f(<span class="number">16</span>, <span class="number">9</span>)，结果为<span class="number">25</span>；</div><div class="line">由于没有更多的元素了，计算结束，返回结果<span class="number">25</span>。</div><div class="line"></div><div class="line"><span class="comment"># 使用reduce()的初始值</span></div><div class="line"></div><div class="line">reduce(f, [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>], <span class="number">100</span>)</div></pre></td></tr></table></figure>
<h3 id="filter-函数"><a href="#filter-函数" class="headerlink" title="filter() 函数"></a>filter() 函数</h3><p>filter()函数接收一个函数 f 和一个list，这个函数 f 的作用是对每个元素进行判断，返回 True或 False，filter()根据判断结果自动过滤掉不符合条件的元素，返回由符合条件元素组成的新list。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 要从一个list [1, 4, 6, 7, 9, 12, 17]中删除偶数，保留奇数，首先，要编写一个判断奇数的函数：</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_odd</span><span class="params">(x)</span>:</span></div><div class="line">    <span class="keyword">return</span> x % <span class="number">2</span> == <span class="number">1</span></div><div class="line"></div><div class="line"><span class="comment"># 然后，利用filter()过滤掉偶数：</span></div><div class="line">filter(is_odd, [<span class="number">1</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">17</span>])</div></pre></td></tr></table></figure>
<h3 id="sorted-函数"><a href="#sorted-函数" class="headerlink" title="sorted() 函数"></a>sorted() 函数</h3><p>sorted()也是一个高阶函数，它可以接收一个比较函数来实现自定义排序，比较函数的定义是，传入两个待比较的元素 x, y，如果 x 应该排在 y 的前面，返回 -1，如果 x 应该排在 y 的后面，返回 1。如果 x 和 y 相等，返回 0。默认是以ASCII大小来比较</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 因此，如果我们要实现倒序排序，只需要编写一个reversed_cmp函数：</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">reversed_cmp</span><span class="params">(x, y)</span>:</span></div><div class="line">    <span class="keyword">if</span> x &gt; y:</div><div class="line">        <span class="keyword">return</span> <span class="number">-1</span></div><div class="line">    <span class="keyword">if</span> x &lt; y:</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span></div><div class="line"></div><div class="line"><span class="comment"># 调用 sorted() 并传入 reversed_cmp 就可以实现倒序排序：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>sorted([<span class="number">36</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">21</span>], reversed_cmp)</div><div class="line">[<span class="number">36</span>, <span class="number">21</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>]</div></pre></td></tr></table></figure>
<h3 id="返回函数"><a href="#返回函数" class="headerlink" title="返回函数"></a>返回函数</h3><p>Python的函数不但可以返回int、str、list、dict等数据类型，还可以返回函数！</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 定义一个函数 f()，我们让它返回一个函数 g，可以这样写：</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">print</span> <span class="string">'call f()...'</span></div><div class="line">    <span class="comment"># 定义函数g:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">g</span><span class="params">()</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">'call g()...'</span></div><div class="line">    <span class="comment"># 返回函数g:</span></div><div class="line">    <span class="keyword">return</span> g</div><div class="line"></div><div class="line"><span class="comment"># 调用函数 f，我们会得到 f 返回的一个函数：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = f()   <span class="comment"># 调用f()</span></div><div class="line">call f()...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x   <span class="comment"># 变量x是f()返回的函数：</span></div><div class="line">&lt;function g at <span class="number">0x1037bf320</span>&gt;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x()   <span class="comment"># x指向函数，因此可以调用</span></div><div class="line">call g()...   <span class="comment"># 调用x()就是执行g()函数定义的代码</span></div><div class="line"></div><div class="line"><span class="comment"># 请注意区分返回函数和返回值：</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">myabs</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">return</span> abs   <span class="comment"># 返回函数</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">myabs2</span><span class="params">(x)</span>:</span></div><div class="line">    <span class="keyword">return</span> abs(x)   <span class="comment"># 返回函数调用的结果，返回值是一个数值</span></div><div class="line"></div><div class="line"><span class="comment"># 实用返回函数可以把一些计算延迟执行</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc_sum</span><span class="params">(lst)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">lazy_sum</span><span class="params">()</span>:</span> <span class="comment"># 这里不需要传入任何参数</span></div><div class="line">        <span class="keyword">return</span> sum(lst)</div><div class="line">    <span class="keyword">return</span> lazy_sum</div><div class="line"></div><div class="line"><span class="comment"># 调用calc_sum()并没有计算出结果，而是返回函数:</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f = calc_sum([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f</div><div class="line">&lt;function lazy_sum at <span class="number">0x1037bfaa0</span>&gt;</div><div class="line"></div><div class="line"><span class="comment"># 对返回的函数进行调用时，才计算出结果:</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f()</div><div class="line"><span class="number">10</span></div></pre></td></tr></table></figure>
<h3 id="函数作用域-LEGB"><a href="#函数作用域-LEGB" class="headerlink" title="函数作用域 LEGB"></a>函数作用域 LEGB</h3><p>L:local 函数内部作用域</p>
<p>E:enclosing 函数内部与内嵌函数之间,与闭包关系密切</p>
<p>G:global 全局作用域</p>
<p>B:build-in 内置作用域</p>
<h3 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h3><p>内层函数引用了外层函数的变量（外层函数的参数也算变量），然后返回内层函数的情况，称为闭包（Closure）。</p>
<p>闭包就是内部函数中对 enclosing 作用域的变量进行引用,也就是对 <strong>closure</strong> 属性的变量进行引用的函数,称为闭包</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc_sum</span><span class="params">(lst)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">lazy_sum</span><span class="params">()</span>:</span></div><div class="line">        <span class="keyword">return</span> sum(lst) <span class="comment"># 引用了外层函数的参数</span></div><div class="line">    <span class="keyword">return</span> lazy_sum</div></pre></td></tr></table></figure>
<p>闭包的特点是返回的函数还引用了外层函数的局部变量，并且这个变量不会被系统回收,而是储存在返回函数的 <strong>closure</strong> 属性中,再次调用被返回的函数的时候,这个变量会用在函数中。并且,返回函数的 <strong>closure</strong> 中的变量只有在函数被返回的那一刻才会被确定,举例如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 希望一次返回3个函数，分别计算1x1,2x2,3x3:</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">count</span><span class="params">()</span>:</span></div><div class="line">    fs = []</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">4</span>):</div><div class="line">        <span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">()</span>:</span></div><div class="line">             <span class="keyword">return</span> i*i</div><div class="line">        fs.append(f)</div><div class="line">    <span class="keyword">return</span> fs</div><div class="line"></div><div class="line">f1, f2, f3 = count() <span class="comment"># count()执行完毕的时候才返回 f 的函数列表,相当于 i = 3,f1 = f</span></div><div class="line"></div><div class="line"><span class="comment"># 所以f1()，f2()和f3()结果看起来是1，4，9，但实际结果全部都是 9</span></div></pre></td></tr></table></figure>
<p>正确的写法应该是返回函数时内层函数不引用外层的循环变量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">count</span><span class="params">()</span>:</span></div><div class="line">    fs = []</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">4</span>):</div><div class="line">        <span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(j)</span>:</span> <span class="comment"># 在内存函数不使用循环变量 i</span></div><div class="line">            <span class="function"><span class="keyword">def</span> <span class="title">g</span><span class="params">()</span>:</span></div><div class="line">                <span class="keyword">return</span> j*j</div><div class="line">            <span class="keyword">return</span> g</div><div class="line">        r = f(i)  <span class="comment"># 在这个时候已经返回了 f 函数,相当于 j = 1,r = g</span></div><div class="line">        fs.append(r)</div><div class="line">    <span class="keyword">return</span> fs</div><div class="line">f1, f2, f3 = count()</div><div class="line"><span class="keyword">print</span> f1(), f2(), f3()</div></pre></td></tr></table></figure>
<h4 id="闭包的作用"><a href="#闭包的作用" class="headerlink" title="闭包的作用"></a>闭包的作用</h4><p>封装</p>
<p>代码复用</p>
<h3 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h3><p>高阶函数可以接收函数做参数，有些时候，我们不需要显式地定义函数，直接传入匿名函数更方便。</p>
<p>在Python中，对匿名函数提供了有限支持。还是以map()函数为例，计算 f(x)=x2 时，除了定义一个f(x)的函数外，还可以直接传入匿名函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; map(lambda x: x * x, [1, 2, 3, 4, 5, 6, 7, 8, 9])</div><div class="line">[1, 4, 9, 16, 25, 36, 49, 64, 81]</div></pre></td></tr></table></figure>
<p>关键词 lambda 表示匿名函数,冒号前面的 x 表示函数参数</p>
<p>匿名函数有个限制,只能有一个表达式,不写 return,返回值就是该表达式的结果</p>
<h3 id="装饰器-decorator"><a href="#装饰器-decorator" class="headerlink" title="装饰器(decorator)"></a>装饰器(decorator)</h3><p>装饰器其实就是对闭包的使用,是Python的一个语法糖</p>
<p>应用场景:已经定义了一个函数,但是在运行时需要增加新的功能,又不想修改原来定义的函数</p>
<p>不使用@的情况下,修饰一个函数的方法:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">f1</span><span class="params">(x)</span>:</span></div><div class="line">    <span class="keyword">return</span> x*<span class="number">2</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">new_fn</span><span class="params">(f)</span>:</span> <span class="comment"># 装饰器函数</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">(x)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">'call'</span> + f.__name__ +<span class="string">'()'</span></div><div class="line">        <span class="keyword">return</span> f(x)</div><div class="line">    <span class="keyword">return</span> fn</div><div class="line"></div><div class="line"><span class="comment"># 换一个名字调用新的函数</span></div><div class="line">g1 = new_fn(f1) <span class="comment"># 相当于 g1 = fn &lt;-- 而 fn 内部 f = f1</span></div><div class="line">g1()</div><div class="line"></div><div class="line"><span class="comment"># 彻底隐藏原始函数的定义进行调用</span></div><div class="line">f1 = new_fn(f1)</div><div class="line">f1()</div></pre></td></tr></table></figure>
<p>使用@的情况下,修饰一个函数的方法:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@new_fn</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">f1</span><span class="params">(x)</span>:</span></div><div class="line">    <span class="keyword">return</span> x*<span class="number">2</span></div><div class="line"></div><div class="line"><span class="comment"># 相当于执行下面的代码</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">f1</span><span class="params">(x)</span>:</span></div><div class="line">    retuen x*<span class="number">2</span></div><div class="line">f1 = new_fn(f1)</div></pre></td></tr></table></figure>
<p>装饰器的作用:可以极大的简化代码,避免每个函数重复编写</p>
<p>打印日志: @log<br>检测性能: @performance<br>数据库事务: @transaction<br>URL路由: @post(‘/register’)</p>
<h3 id="编写无参数装饰器"><a href="#编写无参数装饰器" class="headerlink" title="编写无参数装饰器"></a>编写无参数装饰器</h3><p>Python的 decorator 本质上就是一个高阶函数，它接收一个函数作为参数，然后，返回一个新函数。</p>
<p>使用 decorator 用Python提供的 @ 语法，这样可以避免手动编写 f = decorate(f) 这样的代码。</p>
<p>@log 的定义:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span><span class="params">(f)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">(x)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">'call '</span> + f.__name__ + <span class="string">'()...'</span></div><div class="line">        <span class="keyword">return</span> f(x)</div><div class="line">    <span class="keyword">return</span> fn</div></pre></td></tr></table></figure>
<p>这种情况下的 @log 定义,对一个参数的函数,表现的很好,但是两个或者两个以上参数的函数,就会报错,所以应该对 @log 的定义进行修改,使其适应任意参数的函数</p>
<p>要让 @log 自适应任何参数定义的函数，可以利用Python的 <code>*args</code> 和 <code>**kw</code>，保证任意个数的参数总是能正常调用：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span><span class="params">(f)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">(*args, **kw)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">'call '</span> + f.__name__ + <span class="string">'()...'</span></div><div class="line">        <span class="keyword">return</span> f(*args, **kw)</div><div class="line">    <span class="keyword">return</span> fn</div></pre></td></tr></table></figure>
<p>返回函数运行的时间:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span><span class="params">(prefix)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">log_decorator</span><span class="params">(f)</span>:</span></div><div class="line">        <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kw)</span>:</span></div><div class="line">            <span class="keyword">print</span> <span class="string">'[%s] %s()...'</span> % (prefix, f.__name__)</div><div class="line">            <span class="keyword">return</span> f(*args, **kw)</div><div class="line">        <span class="keyword">return</span> wrapper</div><div class="line">    <span class="keyword">return</span> log_decorator</div><div class="line"></div><div class="line"><span class="meta">@log('DEBUG')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">pass</span></div><div class="line"><span class="keyword">print</span> test()python</div><div class="line"><span class="keyword">import</span> time</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">performance</span><span class="params">(f)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">(*args, **kw)</span>:</span></div><div class="line">        t1 = time.time()</div><div class="line">        r = f(*args, **kw)</div><div class="line">        t2 = time.time()</div><div class="line">        <span class="keyword">print</span> <span class="string">'call %s() in %fs'</span> % (f.__name__, (t2 - t1))</div><div class="line">        <span class="keyword">return</span> r</div><div class="line">    <span class="keyword">return</span> fn</div><div class="line"></div><div class="line"><span class="meta">@performance</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">factorial</span><span class="params">(n)</span>:</span></div><div class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x,y: x*y, range(<span class="number">1</span>, n+<span class="number">1</span>))</div><div class="line"><span class="keyword">print</span> factorial(<span class="number">10</span>)</div></pre></td></tr></table></figure>
<h3 id="带参数的-decorator"><a href="#带参数的-decorator" class="headerlink" title="带参数的 decorator"></a>带参数的 decorator</h3><p>带参数的log函数首先返回一个decorator函数，再让这个decorator函数接收my_func并返回新函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 带参数的装饰器使用形式</span></div><div class="line"><span class="meta">@log('DEBUG')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_func</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">pass</span></div><div class="line"></div><div class="line"><span class="comment"># 相当于:</span></div><div class="line">my_func = log(<span class="string">'DEBUG'</span>)(my_func)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span><span class="params">(prefix)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">log_decorator</span><span class="params">(f)</span>:</span></div><div class="line">        <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kw)</span>:</span></div><div class="line">            <span class="keyword">print</span> <span class="string">'[%s] %s()...'</span> % (prefix, f.__name__)</div><div class="line">            <span class="keyword">return</span> f(*args, **kw)</div><div class="line">        <span class="keyword">return</span> wrapper</div><div class="line">    <span class="keyword">return</span> log_decorator</div><div class="line"></div><div class="line"><span class="comment"># 用带参数的 @log 修饰 test</span></div><div class="line"><span class="meta">@log('DEBUG')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">pass</span></div><div class="line"><span class="keyword">print</span> test()</div><div class="line"></div><div class="line"><span class="comment"># 相当于:</span></div><div class="line">test = log(<span class="string">'DEBUG'</span>)(test)</div><div class="line"></div><div class="line"><span class="comment"># 执行结果</span></div><div class="line">[DEBUG] test()...</div><div class="line"><span class="keyword">None</span></div></pre></td></tr></table></figure>
<p>给 @performace 增加一个参数，允许传入’s’或’ms’：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> time</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">performance</span><span class="params">(unit)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">log_decorator</span><span class="params">(f)</span>:</span></div><div class="line">        <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kw)</span>:</span></div><div class="line">            t1 = time.time()</div><div class="line">            f(*args, **kw)</div><div class="line">            t2 = time.time()</div><div class="line">            <span class="keyword">if</span> unit == <span class="string">'ms'</span>:</div><div class="line">                <span class="keyword">print</span> (t2-t1)*<span class="number">1000</span>,<span class="string">'ms'</span></div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                <span class="keyword">print</span> (t2-t1),<span class="string">'s'</span></div><div class="line">            <span class="keyword">return</span> f(*args, **kw)</div><div class="line">        <span class="keyword">return</span> wrapper</div><div class="line">    <span class="keyword">return</span> log_decorator</div><div class="line"></div><div class="line"><span class="meta">@performance('ms')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">factorial</span><span class="params">(n)</span>:</span></div><div class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x,y: x*y, range(<span class="number">1</span>, n+<span class="number">1</span>))</div><div class="line"></div><div class="line"><span class="keyword">print</span> factorial(<span class="number">10</span>)</div></pre></td></tr></table></figure>
<h3 id="完善-decorator"><a href="#完善-decorator" class="headerlink" title="完善 decorator"></a>完善 decorator</h3><p>decorator改变了函数的<strong>name</strong>等其它属性。如果要让调用者看不出一个函数经过了@decorator的“改造”，就需要把原函数的一些属性复制到新函数中：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 不好的做法</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span><span class="params">(f)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kw)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">'call...'</span></div><div class="line">        <span class="keyword">return</span> f(*args, **kw)</div><div class="line">    wrapper.__name__ = f.__name__</div><div class="line">    wrapper.__doc__ = f.__doc__</div><div class="line">    <span class="keyword">return</span> wrapper</div></pre></td></tr></table></figure>
<p>Python内置的functools可以用来自动化完成这个“复制”的任务：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> functools</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span><span class="params">(f)</span>:</span></div><div class="line"><span class="meta">    @functools.wraps(f)</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kw)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">'call...'</span></div><div class="line">        <span class="keyword">return</span> f(*args, **kw)</div><div class="line">    <span class="keyword">return</span> wrapper</div></pre></td></tr></table></figure>
<p>但是这种做法,会改变原函数的签名<code>(*args, **kw)</code></p>
<h3 id="偏函数"><a href="#偏函数" class="headerlink" title="偏函数"></a>偏函数</h3><p>functools.partial可以把一个参数多的函数变成一个参数少的新函数，少的参数需要在创建时指定默认值，这样，新函数调用的难度就降低了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> functools</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>int2 = functools.partial(int, base=<span class="number">2</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>int2(<span class="string">'1000000'</span>)</div><div class="line"><span class="number">64</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>int2(<span class="string">'1010101'</span>)</div><div class="line"><span class="number">85</span></div></pre></td></tr></table></figure>
<h2 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h2><p>模块的名字就是 .py 文件的文件名</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># test.py  # &lt;-- 模块名</span></div><div class="line"><span class="keyword">import</span> math  <span class="comment"># &lt;-- 调用模块</span></div><div class="line"><span class="keyword">print</span> math.pow(<span class="number">2</span>, <span class="number">10</span>)  <span class="comment"># &lt;-- 调用模块的函数</span></div></pre></td></tr></table></figure>
<p>解决模块名重名的问题:把同名的模块放入不同的包中</p>
<p>p1/test.py 将 test.py 模块文件放入 p1 包中,完整的模块名就叫做 p1.util<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># test.py</span></div><div class="line"><span class="keyword">import</span> p1.util</div><div class="line"><span class="keyword">print</span> p1.util.f(<span class="number">2</span>, <span class="number">10</span>)</div></pre></td></tr></table></figure></p>
<p>区别包和目录,就是包下面必须有一个 <strong>init</strong>.py,包的每一层目录都要有这个文件,这样 Python 才能把这个目录当成一个包来处理</p>
<h3 id="导入模块"><a href="#导入模块" class="headerlink" title="导入模块"></a>导入模块</h3><p>导入系统自带的模块 math：</p>
<p><code>import math</code></p>
<p>导入 math 模块的某几个函数:</p>
<p><code>from math import pow, sin, log</code></p>
<p>如果使用 from…import 导入模块,如果两个模块有名字相同的函数,那么就会出现冲突,解决的办法是起一个别名来避免冲突:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> math <span class="keyword">import</span> log</div><div class="line"><span class="keyword">from</span> logging <span class="keyword">import</span> log <span class="keyword">as</span> logger</div></pre></td></tr></table></figure>
<h3 id="动态导入模块"><a href="#动态导入模块" class="headerlink" title="动态导入模块"></a>动态导入模块</h3><p>如果导入的模块不存在，Python解释器会报 ImportError 错误</p>
<p>StringIO 是纯Python代码编写的，而 cStringIO 部分函数是 C 写的，因此 cStringIO 运行速度更快。</p>
<p>利用ImportError错误，我们经常在Python中动态导入模块：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">try</span>:</div><div class="line">    <span class="keyword">from</span> cStringIO <span class="keyword">import</span> StringIO</div><div class="line"><span class="keyword">except</span> ImportError:</div><div class="line">    <span class="keyword">from</span> StringIO <span class="keyword">import</span> StringIO</div></pre></td></tr></table></figure>
<p>try 的作用是捕获错误，并在捕获到指定错误时执行 except 语句。</p>
<h3 id="使用-future"><a href="#使用-future" class="headerlink" title="使用 future"></a>使用 <strong>future</strong></h3><p>Python的新版本会引入新的功能，但是，实际上这些功能在上一个老版本中就已经存在了。要“试用”某一新的特性，就可以通过导入<strong>future</strong>模块的某些功能来实现。</p>
<p>要在Python 2.7中引入3.x的除法规则，导入<strong>future</strong>的division：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> division</div><div class="line"><span class="keyword">print</span> <span class="number">10</span> / <span class="number">3</span></div><div class="line"><span class="comment"># 结果</span></div><div class="line"><span class="number">3.333333333333335</span></div></pre></td></tr></table></figure>
<h3 id="安装第三方模块"><a href="#安装第三方模块" class="headerlink" title="安装第三方模块"></a>安装第三方模块</h3><p>使用 pip</p>
<p><code>pip install &lt;第三方模块的名字&gt;</code></p>
<p>然后就可以使用 python 导入模块了</p>
<h2 id="面向对象编程"><a href="#面向对象编程" class="headerlink" title="面向对象编程"></a>面向对象编程</h2><p>面向对象编程是一种程序设计范式,把程序看做不同对象的相互调用</p>
<p>类:用于定义抽象类型</p>
<p>实例:根据类的定义被创建出来</p>
<p>比如说人是一个类,而小明,小红都是实例</p>
<h3 id="定义类-创建实例"><a href="#定义类-创建实例" class="headerlink" title="定义类,创建实例"></a>定义类,创建实例</h3><p>在Python中，类通过 class 关键字定义。以 Person 为例，定义一个Person类如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="keyword">pass</span></div></pre></td></tr></table></figure>
<p>Python 的编程习惯，类名以大写字母开头，紧接着是(object)，表示该类是从哪个类继承下来的。类的继承将在后面的章节讲解，现在我们只需要简单地从object类继承。</p>
<h3 id="创建实例属性"><a href="#创建实例属性" class="headerlink" title="创建实例属性"></a>创建实例属性</h3><p>由于Python是动态语言，对每一个实例，都可以直接给他们的属性赋值，例如，给xiaoming这个实例加上name、gender和birth属性：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">xiaoming = Person()</div><div class="line">xiaoming.name = <span class="string">'Xiao Ming'</span></div><div class="line">xiaoming.gender = <span class="string">'Male'</span></div><div class="line">xiaoming.birth = <span class="string">'1990-1-1'</span></div></pre></td></tr></table></figure>
<p>给xiaohong加上的属性不一定要和xiaoming相同：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">xiaohong = Person()</div><div class="line">xiaohong.name = <span class="string">'Xiao Hong'</span></div><div class="line">xiaohong.school = <span class="string">'No. 1 High School'</span></div><div class="line">xiaohong.grade = <span class="number">2</span></div></pre></td></tr></table></figure>
<p>实例的属性可以像普通变量一样进行操作：</p>
<p><code>xiaohong.grade = xiaohong.grade + 1</code></p>
<h3 id="初始化实例属性"><a href="#初始化实例属性" class="headerlink" title="初始化实例属性"></a>初始化实例属性</h3><p>现实世界中，一种类型的实例应该拥有相同名字的属性。例如，Person类应该在创建的时候就拥有 name、gender 和 birth 属性</p>
<p>在定义 Person 类时，可以为Person类添加一个特殊的<strong>init</strong>()方法，当创建实例时，<strong>init</strong>()方法被自动调用，我们就能在此为每个实例都统一加上以下属性：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, gender, birth)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        self.gender = gender</div><div class="line">        self.birth = birth</div></pre></td></tr></table></figure>
<p><strong>init</strong>() 方法的第一个参数必须是 self（也可以用别的名字，但建议使用习惯用法），后续参数则可以自由指定，和定义函数没有任何区别。</p>
<p>相应地，创建实例时，就必须要提供除 self 以外的参数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">xiaoming = Person(<span class="string">'Xiao Ming'</span>, <span class="string">'Male'</span>, <span class="string">'1991-1-1'</span>)</div><div class="line">xiaohong = Person(<span class="string">'Xiao Hong'</span>, <span class="string">'Female'</span>, <span class="string">'1992-2-2'</span>)</div></pre></td></tr></table></figure>
<p>有了<strong>init</strong>()方法，每个Person实例在创建时，都会有 name、gender 和 birth 这3个属性，并且，被赋予不同的属性值，访问属性使用<code>.</code>操作符：</p>
<p>定义Person类的<strong>init</strong>方法，除了接受 name、gender 和 birth 外，还可接受任意关键字参数，并把他们都作为属性赋值给实例:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 要定义关键字参数，使用 **kw；</span></div><div class="line"></div><div class="line"><span class="comment"># 除了可以直接使用self.name = 'xxx'设置一个属性外，还可以通过 setattr(self, 'name', 'xxx') 设置属性。</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, gender, birth, **kw)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        self.gender = gender</div><div class="line">        self.birth = birth</div><div class="line">        <span class="keyword">for</span> k, v <span class="keyword">in</span> kw.iteritems():</div><div class="line">            setattr(self, k, v)</div></pre></td></tr></table></figure>
<h3 id="访问限制"><a href="#访问限制" class="headerlink" title="访问限制"></a>访问限制</h3><p>Python对属性权限的控制是通过属性名来实现的，如果一个属性由双下划线开头<code>(__)</code>，该属性就无法被外部访问。看例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        self._title = <span class="string">'Mr'</span></div><div class="line">        self.__job = <span class="string">'Student'</span></div><div class="line">p = Person(<span class="string">'Bob'</span>)</div><div class="line"><span class="keyword">print</span> p.name</div><div class="line"><span class="comment"># =&gt; Bob</span></div><div class="line"><span class="keyword">print</span> p._title</div><div class="line"><span class="comment"># =&gt; Mr</span></div><div class="line"><span class="keyword">print</span> p.__job</div><div class="line"><span class="comment"># =&gt; Error</span></div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">AttributeError: <span class="string">'Person'</span> object has no attribute <span class="string">'__job'</span></div></pre></td></tr></table></figure>
<p>可见，只有以双下划线开头的<code>&quot;__job&quot;</code>不能直接被外部访问。</p>
<p>但是，如果一个属性以 <strong>xxx</strong> 的形式定义，那它又可以被外部访问了，以 <strong>xxx</strong> 定义的属性在Python的类中被称为特殊属性，有很多预定义的特殊属性可以使用，通常我们不要把普通属性用 <strong>xxx</strong> 定义。</p>
<p>以单下划线开头的属性_xxx虽然也可以被外部访问，但是，按照习惯，他们不应该被外部访问。</p>
<h3 id="创建类属性"><a href="#创建类属性" class="headerlink" title="创建类属性"></a>创建类属性</h3><p>类本身也是一个对象，如果在类上绑定一个属性，则所有实例都可以访问类的属性，并且，所有实例访问的类属性都是同一个！也就是说，实例属性每个实例各自拥有，互相独立，而类属性有且只有一份。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 定义类的属性</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span></div><div class="line">    address = <span class="string">'Earth'</span> <span class="comment"># 直接在class 中定义类的属性</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></div><div class="line">        self.name = name</div><div class="line"></div><div class="line"><span class="comment"># 因为类属性是直接绑定在类上的，所以，访问类属性不需要创建实例，就可以直接访问：.</span></div><div class="line"><span class="keyword">print</span> Person.address</div><div class="line"><span class="comment"># =&gt; Earth</span></div><div class="line"></div><div class="line"><span class="comment"># 对一个实例调用类的属性也是可以访问的，所有实例都可以访问到它所属的类的属性：</span></div><div class="line">p1 = Person(<span class="string">'Bob'</span>)</div><div class="line">p2 = Person(<span class="string">'Alice'</span>)</div><div class="line"><span class="keyword">print</span> p1.address</div><div class="line"><span class="comment"># =&gt; Earth</span></div><div class="line"><span class="keyword">print</span> p2.address</div><div class="line"><span class="comment"># =&gt; Earth</span></div><div class="line"></div><div class="line"><span class="comment"># 由于Python是动态语言，类属性也是可以动态添加和修改的：</span></div><div class="line">Person.address = <span class="string">'China'</span></div><div class="line"><span class="keyword">print</span> p1.address</div><div class="line"><span class="comment"># =&gt; 'China'</span></div><div class="line"><span class="keyword">print</span> p2.address</div><div class="line"><span class="comment"># =&gt; 'China'</span></div><div class="line"></div><div class="line"><span class="comment"># 因为类属性只有一份，所以，当Person类的address改变时，所有实例访问到的类属性都改变了。</span></div></pre></td></tr></table></figure>
<h3 id="解决类的属性和实例属性名字冲突的问题"><a href="#解决类的属性和实例属性名字冲突的问题" class="headerlink" title="解决类的属性和实例属性名字冲突的问题"></a>解决类的属性和实例属性名字冲突的问题</h3><p>当实例属性和类属性重名时，实例属性优先级高，它将屏蔽掉对类属性的访问。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span></div><div class="line">    address = <span class="string">'Earth'</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></div><div class="line">        self.name = name</div><div class="line"></div><div class="line">p1 = Person(<span class="string">'Bob'</span>)</div><div class="line">p2 = Person(<span class="string">'Alice'</span>)</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">'Person.address = '</span> + Person.address</div><div class="line"></div><div class="line">p1.address = <span class="string">'China'</span></div><div class="line"><span class="keyword">print</span> <span class="string">'p1.address = '</span> + p1.address</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">'Person.address = '</span> + Person.address</div><div class="line"><span class="keyword">print</span> <span class="string">'p2.address = '</span> + p2.address</div><div class="line"></div><div class="line"><span class="comment"># 结果如下</span></div><div class="line">Person.address = Earth</div><div class="line">p1.address = China</div><div class="line">Person.address = Earth</div><div class="line">p2.address = Earth</div></pre></td></tr></table></figure>
<h3 id="定义实例方法"><a href="#定义实例方法" class="headerlink" title="定义实例方法"></a>定义实例方法</h3><p>实例的方法就是在类中定义的函数，它的第一个参数永远是 self，指向调用该方法的实例本身，其他参数和一个普通函数是完全一样的：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></div><div class="line">        self.__name = name</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_name</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.__name</div></pre></td></tr></table></figure>
<p>get_name(self) 就是一个实例方法，它的第一个参数是self。<strong>init</strong>(self, name)其实也可看做是一个特殊的实例方法。</p>
<p>调用实例方法必须在实例上调用：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">p1 = Person(<span class="string">'Bob'</span>)</div><div class="line"><span class="keyword">print</span> p1.get_name()  <span class="comment"># self不需要显式传入</span></div><div class="line"><span class="comment"># =&gt; Bob</span></div></pre></td></tr></table></figure>
<p>在实例方法内部，可以访问所有实例属性，这样，如果外部需要访问私有属性，可以通过方法调用获得，这种数据封装的形式除了能保护内部数据一致性外，还可以简化外部调用的难度。</p>
<h3 id="方法也是属性"><a href="#方法也是属性" class="headerlink" title="方法也是属性"></a>方法也是属性</h3><p>我们在 class 中定义的实例方法其实也是属性，它实际上是一个函数对象：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, score)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        self.score = score</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_grade</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'A'</span></div><div class="line"></div><div class="line">p1 = Person(<span class="string">'Bob'</span>, <span class="number">90</span>)</div><div class="line"><span class="keyword">print</span> p1.get_grade</div><div class="line"><span class="comment"># =&gt; &lt;bound method Person.get_grade of &lt;__main__.Person object at 0x109e58510&gt;&gt;</span></div><div class="line"><span class="keyword">print</span> p1.get_grade()</div><div class="line"><span class="comment"># =&gt; A</span></div></pre></td></tr></table></figure>
<p>也就是说，p1.get_grade 返回的是一个函数对象，但这个函数是一个绑定到实例的函数，p1.get_grade() 才是方法调用。</p>
<p>因为方法也是一个属性，所以，它也可以动态地添加到实例上，只是需要用 types.MethodType() 把一个函数变为一个方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> types</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn_get_grade</span><span class="params">(self)</span>:</span></div><div class="line">    <span class="keyword">if</span> self.score &gt;= <span class="number">80</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">'A'</span></div><div class="line">    <span class="keyword">if</span> self.score &gt;= <span class="number">60</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">'B'</span></div><div class="line">    <span class="keyword">return</span> <span class="string">'C'</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, score)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        self.score = score</div><div class="line"></div><div class="line">p1 = Person(<span class="string">'Bob'</span>, <span class="number">90</span>)</div><div class="line">p1.get_grade = types.MethodType(fn_get_grade, p1, Person)</div><div class="line"><span class="keyword">print</span> p1.get_grade()</div><div class="line"><span class="comment"># =&gt; A</span></div><div class="line">p2 = Person(<span class="string">'Alice'</span>, <span class="number">65</span>)</div><div class="line"><span class="keyword">print</span> p2.get_grade()</div><div class="line"><span class="comment"># ERROR: AttributeError: 'Person' object has no attribute 'get_grade'</span></div><div class="line"><span class="comment"># 因为p2实例并没有绑定get_grade</span></div></pre></td></tr></table></figure>
<p>给一个实例动态添加方法并不常见，直接在class中定义要更直观。</p>
<p>实例的属性也可以是一个函数,和方法的区别是,不需要传入self参数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, score)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        self.score = score</div><div class="line">        self.get_grade = <span class="keyword">lambda</span>: <span class="string">'A'</span> <span class="comment"># self.get_grade属性 是一个函数</span></div><div class="line"></div><div class="line">p1 = Person(<span class="string">'Bob'</span>, <span class="number">90</span>)</div><div class="line"><span class="keyword">print</span> p1.get_grade</div><div class="line"><span class="keyword">print</span> p1.get_grade()</div></pre></td></tr></table></figure>
<p>定义类方法</p>
<p>在class中定义的全部是实例方法，实例方法第一个参数 self 是实例本身。</p>
<p>要在class中定义类方法，需要这么写：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span></div><div class="line">    count = <span class="number">0</span></div><div class="line"><span class="meta">    @classmethod</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">how_many</span><span class="params">(cls)</span>:</span></div><div class="line">        <span class="keyword">return</span> cls.count</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        Person.count = Person.count + <span class="number">1</span></div></pre></td></tr></table></figure>
<p>通过标记一个 @classmethod，该方法将绑定到 Person 类上，而非类的实例。类方法的第一个参数将传入类本身，通常将参数名命名为 cls，上面的 cls.count 实际上相当于 Person.count。</p>
<p>因为是在类上调用，而非实例上调用，因此类方法无法获得任何实例变量，只能获得类的引用。</p>
<h2 id="类的继承"><a href="#类的继承" class="headerlink" title="类的继承"></a>类的继承</h2><p>新类不必从头编写,新类从现有的类集成,就拥有了该类所有的功能,新类只需要编写现有类缺失的功能</p>
<p>继承的特点</p>
<p>子类和父类是 is 关系</p>
<p>Student类和Books类是has关系,那么就不能使用继承,而使用组合.Book作为Student的属性</p>
<h3 id="继承一个类"><a href="#继承一个类" class="headerlink" title="继承一个类"></a>继承一个类</h3><p>如果已经定义了Person类，需要定义新的Student和Teacher类时，可以直接从Person类继承：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, gender)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        self.gender = gender</div></pre></td></tr></table></figure></p>
<p>定义Student类时，只需要把额外的属性加上，例如score：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(Person)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, gender, score)</span>:</span></div><div class="line">        super(Student, self).__init__(name, gender)</div><div class="line">        self.score = score</div></pre></td></tr></table></figure>
<p>一定要用 super(Student, self).<strong>init</strong>(name, gender) 去初始化父类，否则，继承自 Person 的 Student 将没有 name 和 gender。</p>
<p>函数super(Student, self)将返回当前类继承的父类，即 Person ，然后调用<strong>init</strong>()方法，注意self参数已在super()中传入，在<strong>init</strong>()中将隐式传递，不需要写出（也不能写）。</p>
<h3 id="判断类型"><a href="#判断类型" class="headerlink" title="判断类型"></a>判断类型</h3><p>函数isinstance()可以判断一个变量的类型，既可以用在Python内置的数据类型如str、list、dict，也可以用在我们自定义的类，它们本质上都是数据类型。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">p = Person(<span class="string">'Tim'</span>, <span class="string">'Male'</span>)</div><div class="line">s = Student(<span class="string">'Bob'</span>, <span class="string">'Male'</span>, <span class="number">88</span>)</div><div class="line">t = Teacher(<span class="string">'Alice'</span>, <span class="string">'Female'</span>, <span class="string">'English'</span>)</div><div class="line"></div><div class="line"><span class="comment"># 当我们拿到变量 p、s、t 时，可以使用 isinstance 判断类型：</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(p, Person)</div><div class="line"><span class="keyword">True</span>    <span class="comment"># p是Person类型</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(p, Student)</div><div class="line"><span class="keyword">False</span>   <span class="comment"># p不是Student类型</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(p, Teacher)</div><div class="line"><span class="keyword">False</span>   <span class="comment"># p不是Teacher类型</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(s, Person)</div><div class="line"><span class="keyword">True</span>    <span class="comment"># s是Person类型</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(s, Student)</div><div class="line"><span class="keyword">True</span>    <span class="comment"># s是Student类型</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(s, Teacher)</div><div class="line"><span class="keyword">False</span>   <span class="comment"># s不是Teacher类型</span></div></pre></td></tr></table></figure>
<p>在一条继承链上面,一个实例可以看成它本身的类型,也可以看成它父类的类型</p>
<h3 id="多态"><a href="#多态" class="headerlink" title="多态"></a>多态</h3><p>动态语言调用实例方法，不检查类型，只要方法存在，参数正确，就可以调用。</p>
<h3 id="多重继承"><a href="#多重继承" class="headerlink" title="多重继承"></a>多重继承</h3><p>除了从一个父类继承外，Python允许从多个父类继承，称为多重继承。只需要在填写父类的时候将两个需要继承的父类都写上就好了:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, a)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">'init A...'</span></div><div class="line">        self.a = a</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span><span class="params">(A)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, a)</span>:</span></div><div class="line">        super(B, self).__init__(a)</div><div class="line">        <span class="keyword">print</span> <span class="string">'init B...'</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span><span class="params">(A)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, a)</span>:</span></div><div class="line">        super(C, self).__init__(a)</div><div class="line">        <span class="keyword">print</span> <span class="string">'init C...'</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span><span class="params">(B, C)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, a)</span>:</span></div><div class="line">        super(D, self).__init__(a)</div><div class="line">        <span class="keyword">print</span> <span class="string">'init D...'</span></div></pre></td></tr></table></figure>
<h3 id="获取对象信息"><a href="#获取对象信息" class="headerlink" title="获取对象信息"></a>获取对象信息</h3><p>首先可以用 type() 函数获取变量的类型，它返回一个 Type 对象</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;</span>&gt;&gt; type(123)</div><div class="line">&lt;type 'int'&gt;</div><div class="line"><span class="meta">&gt;</span>&gt;&gt; s = Student('Bob', 'Male', 88)</div><div class="line"><span class="meta">&gt;</span>&gt;&gt; type(s)</div><div class="line">&lt;class '__main__.Student'&gt;</div></pre></td></tr></table></figure>
<p>其次，可以用 dir() 函数获取变量的所有属性：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;</span>&gt;&gt; dir(123)   # 整数也有很多属性...</div><div class="line">['__abs__', '__add__', '__and__', '__class__', '__cmp__', ...]</div><div class="line"></div><div class="line"><span class="meta">&gt;</span>&gt;&gt; dir(s)</div><div class="line">['__class__', '__delattr__', '__dict__', '__doc__', '__format__', '__getattribute__', '__hash__', '__init__', '__module__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', 'gender', 'name', 'score', 'whoAmI']</div></pre></td></tr></table></figure>
<p>如果已知一个属性名称，要获取或者设置对象的属性，就需要用 getattr() 和 setattr( )函数了：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;</span>&gt;&gt; getattr(s, 'name')  # 获取name属性</div><div class="line">'Bob'</div><div class="line"></div><div class="line"><span class="meta">&gt;</span>&gt;&gt; setattr(s, 'name', 'Adam')  # 设置新的name属性</div><div class="line"></div><div class="line"><span class="meta">&gt;</span>&gt;&gt; s.name</div><div class="line">'Adam'</div><div class="line"></div><div class="line"><span class="meta">&gt;</span>&gt;&gt; getattr(s, 'age')  # 获取age属性，但是属性不存在，报错：</div><div class="line">Traceback (most recent call last):</div><div class="line">  File "&lt;stdin&gt;", line 1, in &lt;module&gt;</div><div class="line">AttributeError: 'Student' object has no attribute 'age'</div><div class="line"></div><div class="line"><span class="meta">&gt;</span>&gt;&gt; getattr(s, 'age', 20)  # 获取age属性，如果属性不存在，就返回默认值20：</div><div class="line">20</div></pre></td></tr></table></figure>
<p>传入<code>**kw</code>即可传入任意数量的参数，并通过 setattr() 绑定属性:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, gender, **kw)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        self.gender = gender</div><div class="line">        <span class="keyword">for</span> k, v <span class="keyword">in</span> kw.iteritems():</div><div class="line">            setattr(self, k, v)</div><div class="line"></div><div class="line">p = Person(<span class="string">'Bob'</span>, <span class="string">'Male'</span>, age=<span class="number">18</span>, course=<span class="string">'Python'</span>)</div><div class="line"><span class="keyword">print</span> p.age</div><div class="line"><span class="keyword">print</span> p.course</div></pre></td></tr></table></figure>
<h2 id="定制类"><a href="#定制类" class="headerlink" title="定制类"></a>定制类</h2><p>特殊方法定义在 class 中</p>
<p>不需要直接调用</p>
<p>Python 的某些函数或操作符会自动调用这些特殊方法</p>
<h3 id="str-和-repr"><a href="#str-和-repr" class="headerlink" title="str 和 repr"></a><strong>str</strong> 和 <strong>repr</strong></h3><p>如果要把一个类的实例变成 str，就需要实现特殊方法<strong>str</strong>()：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, gender)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        self.gender = gender</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'(Person: %s, %s)'</span> % (self.name, self.gender)</div></pre></td></tr></table></figure>
<p>因为 Python 定义了<strong>str</strong>()和<strong>repr</strong>()两种方法，<strong>str</strong>()用于显示给用户，而<strong>repr</strong>()用于显示给开发人员。</p>
<p>有一个偷懒的定义<strong>repr</strong>的方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, gender)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        self.gender = gender</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'(Person: %s, %s)'</span> % (self.name, self.gender)</div><div class="line">    __repr__ = __str__</div></pre></td></tr></table></figure>
<h3 id="cmp"><a href="#cmp" class="headerlink" title="cmp"></a><strong>cmp</strong></h3><p>对 int、str 等内置数据类型排序时，Python的 sorted() 按照默认的比较函数 cmp 排序，但是，如果对一组 Student 类的实例排序时，就必须提供我们自己的特殊方法 <strong>cmp</strong>()：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, score)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        self.score = score</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'(%s: %s)'</span> % (self.name, self.score)</div><div class="line">    __repr__ = __str__</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__cmp__</span><span class="params">(self, s)</span>:</span></div><div class="line">        <span class="keyword">if</span> self.name &lt; s.name:</div><div class="line">            <span class="keyword">return</span> <span class="number">-1</span></div><div class="line">        <span class="keyword">elif</span> self.name &gt; s.name:</div><div class="line">            <span class="keyword">return</span> <span class="number">1</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span></div></pre></td></tr></table></figure>
<h3 id="len"><a href="#len" class="headerlink" title="len"></a><strong>len</strong></h3><p>要让 len() 函数工作正常，类必须提供一个特殊方法<strong>len</strong>()，它返回元素的个数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">class Students(object):</div><div class="line">    def __init__(self, *args):</div><div class="line">        self.names = args</div><div class="line">    def __len__(self):</div><div class="line">        return len(self.names)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">x = 0</div><div class="line">y = 1</div><div class="line"></div><div class="line">x, y = y, x + y # 计算用的是没有变化的值没有先后关系</div><div class="line"># 结果是  x = 1, y = 1</div><div class="line"></div><div class="line">x = y</div><div class="line">y = x + y</div><div class="line"># 结果是  x = 1, y = 2 # x 先被计算,y 后被计算</div><div class="line"></div><div class="line">所以两种写法的执行结果不同</div></pre></td></tr></table></figure>
<h3 id="数学运算"><a href="#数学运算" class="headerlink" title="数学运算"></a>数学运算</h3><p>要表示有理数，可以用一个Rational类来表示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rational</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, p, q)</span>:</span></div><div class="line">        self.p = p</div><div class="line">        self.q = q</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__add__</span><span class="params">(self, r)</span>:</span></div><div class="line">        <span class="keyword">return</span> Rational(self.p * r.q + self.q * r.p, self.q * r.q)</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'%s/%s'</span> % (self.p, self.q)</div><div class="line">    __repr__ = __str__</div></pre></td></tr></table></figure>
<p>减法运算：<strong>sub</strong><br>乘法运算：<strong>mul</strong><br>除法运算：<strong>div</strong></p>
<h3 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h3><p>要让int()函数正常工作，只需要实现特殊方法<strong>int</strong>():</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rational</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, p, q)</span>:</span></div><div class="line">        self.p = p</div><div class="line">        self.q = q</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__int__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.p // self.q</div></pre></td></tr></table></figure>
<p>同理，要让float()函数正常工作，只需要实现特殊方法<strong>float</strong>()</p>
<h3 id="property"><a href="#property" class="headerlink" title="@property"></a>@property</h3><p>可以将类的函数装饰成属性调用:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, score)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        self.__score = score <span class="comment"># score 是限制属性</span></div><div class="line"><span class="meta">    @property</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">score</span><span class="params">(self)</span>:</span> <span class="comment"># 装饰 score 函数为一个 get 方法</span></div><div class="line">        <span class="keyword">return</span> self.__score</div><div class="line"><span class="meta">    @score.setter</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">score</span><span class="params">(self, score)</span>:</span> <span class="comment"># 装饰 score 函数为一个 set 方法</span></div><div class="line">        <span class="keyword">if</span> score &lt; <span class="number">0</span> <span class="keyword">or</span> score &gt; <span class="number">100</span>:</div><div class="line">            <span class="keyword">raise</span> ValueError(<span class="string">'invalid score'</span>)</div><div class="line">        self.__score = score</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"># 就可以像属性调用那样对属性进行赋值了</div><div class="line"></div><div class="line">&gt;&gt;&gt; s = Student(&apos;Bob&apos;, 59)</div><div class="line">&gt;&gt;&gt; s.score = 60</div><div class="line">&gt;&gt;&gt; print s.score</div><div class="line">60</div><div class="line">&gt;&gt;&gt; s.score = 1000</div><div class="line">Traceback (most recent call last):</div><div class="line">  ...</div><div class="line">ValueError: invalid score</div></pre></td></tr></table></figure>
<p>第一个score(self)是get方法，用@property装饰，第二个score(self, score)是set方法，用@score.setter装饰，@score.setter是前一个@property装饰后的副产品。</p>
<h3 id="slots"><a href="#slots" class="headerlink" title="slots"></a><strong>slots</strong></h3><p>由于Python是动态语言，任何实例在运行期都可以动态地添加属性。</p>
<p>如果要限制添加的属性，例如，Student类只允许添加 name、gender和score 这3个属性，就可以利用Python的一个特殊的<strong>slots</strong>来实现。</p>
<p>顾名思义，<strong>slots</strong> 是指一个类允许的属性列表：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(object)</span>:</span></div><div class="line">    __slots__ = (<span class="string">'name'</span>, <span class="string">'gender'</span>, <span class="string">'score'</span>)</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, gender, score)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        self.gender = gender</div><div class="line">        self.score = score</div></pre></td></tr></table></figure>
<p><strong>slots</strong> 的目的是限制当前类所能拥有的属性，如果不需要添加任意动态的属性，使用 <strong>slots</strong> 也能节省内存。</p>
<h3 id="call"><a href="#call" class="headerlink" title="call"></a><strong>call</strong></h3><p>在Python中，函数其实是一个对象,由于可以调用,称为可调用对象</p>
<p>一个类实例也可以变成一个可调用对象，只需要实现一个特殊方法<strong>call</strong>():</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, gender)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        self.gender = gender</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(self, friend)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">'My name is %s...'</span> % self.name</div><div class="line">        <span class="keyword">print</span> <span class="string">'My friend is %s...'</span> % friend</div></pre></td></tr></table></figure>
<p>现在可以直接对类进行调用</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;</span>&gt;&gt; p = Person('Bob', 'male')</div><div class="line"><span class="meta">&gt;</span>&gt;&gt; p('Tim')</div><div class="line">My name is Bob...</div><div class="line">My friend is Tim...</div></pre></td></tr></table></figure>
<p>单看 p(‘Tim’) 你无法确定 p 是一个函数还是一个类实例，所以，在Python中，函数也是对象，对象和函数的区别并不显著。</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        
  <ul class="post-copyright">
    <li class="post-copyright-author">
      <strong>本文作者：</strong>
      NingAnMe
    </li>
    <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="http://ninganme.github.io/2017-07-13-python-advanced.html" title="Python 进阶">http://ninganme.github.io/2017-07-13-python-advanced.html</a>
    </li>
    <li class="post-copyright-license">
      <strong>版权声明： </strong>
      本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处！
    </li>
  </ul>


      
    </div>

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017-07-12-ubuntu-python-environment.html" rel="next" title="Ubuntu 系统上详细配置 Python 工作学习一体化环境">
                <i class="fa fa-chevron-left"></i> Ubuntu 系统上详细配置 Python 工作学习一体化环境
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017-07-17-python-oop.html" rel="prev" title="Python 面向对象">
                Python 面向对象 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/touxiang.jpg"
               alt="NingAnMe" />
          <p class="site-author-name" itemprop="name">NingAnMe</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">20</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/ninganme" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#内容"><span class="nav-number">1.</span> <span class="nav-text">内容</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#python函数式编程"><span class="nav-number">2.</span> <span class="nav-text">python函数式编程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#高阶函数"><span class="nav-number">2.1.</span> <span class="nav-text">高阶函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Python-中的高阶函数"><span class="nav-number">3.</span> <span class="nav-text">Python 中的高阶函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#map-函数"><span class="nav-number">3.1.</span> <span class="nav-text">map()函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reduce-函数"><span class="nav-number">3.2.</span> <span class="nav-text">reduce() 函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#filter-函数"><span class="nav-number">3.3.</span> <span class="nav-text">filter() 函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sorted-函数"><span class="nav-number">3.4.</span> <span class="nav-text">sorted() 函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#返回函数"><span class="nav-number">3.5.</span> <span class="nav-text">返回函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#函数作用域-LEGB"><span class="nav-number">3.6.</span> <span class="nav-text">函数作用域 LEGB</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#闭包"><span class="nav-number">3.7.</span> <span class="nav-text">闭包</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#闭包的作用"><span class="nav-number">3.7.1.</span> <span class="nav-text">闭包的作用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#匿名函数"><span class="nav-number">3.8.</span> <span class="nav-text">匿名函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#装饰器-decorator"><span class="nav-number">3.9.</span> <span class="nav-text">装饰器(decorator)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#编写无参数装饰器"><span class="nav-number">3.10.</span> <span class="nav-text">编写无参数装饰器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#带参数的-decorator"><span class="nav-number">3.11.</span> <span class="nav-text">带参数的 decorator</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#完善-decorator"><span class="nav-number">3.12.</span> <span class="nav-text">完善 decorator</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#偏函数"><span class="nav-number">3.13.</span> <span class="nav-text">偏函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#模块"><span class="nav-number">4.</span> <span class="nav-text">模块</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#导入模块"><span class="nav-number">4.1.</span> <span class="nav-text">导入模块</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#动态导入模块"><span class="nav-number">4.2.</span> <span class="nav-text">动态导入模块</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-future"><span class="nav-number">4.3.</span> <span class="nav-text">使用 future</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装第三方模块"><span class="nav-number">4.4.</span> <span class="nav-text">安装第三方模块</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#面向对象编程"><span class="nav-number">5.</span> <span class="nav-text">面向对象编程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#定义类-创建实例"><span class="nav-number">5.1.</span> <span class="nav-text">定义类,创建实例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建实例属性"><span class="nav-number">5.2.</span> <span class="nav-text">创建实例属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#初始化实例属性"><span class="nav-number">5.3.</span> <span class="nav-text">初始化实例属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#访问限制"><span class="nav-number">5.4.</span> <span class="nav-text">访问限制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建类属性"><span class="nav-number">5.5.</span> <span class="nav-text">创建类属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#解决类的属性和实例属性名字冲突的问题"><span class="nav-number">5.6.</span> <span class="nav-text">解决类的属性和实例属性名字冲突的问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#定义实例方法"><span class="nav-number">5.7.</span> <span class="nav-text">定义实例方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#方法也是属性"><span class="nav-number">5.8.</span> <span class="nav-text">方法也是属性</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#类的继承"><span class="nav-number">6.</span> <span class="nav-text">类的继承</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#继承一个类"><span class="nav-number">6.1.</span> <span class="nav-text">继承一个类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#判断类型"><span class="nav-number">6.2.</span> <span class="nav-text">判断类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多态"><span class="nav-number">6.3.</span> <span class="nav-text">多态</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多重继承"><span class="nav-number">6.4.</span> <span class="nav-text">多重继承</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#获取对象信息"><span class="nav-number">6.5.</span> <span class="nav-text">获取对象信息</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#定制类"><span class="nav-number">7.</span> <span class="nav-text">定制类</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#str-和-repr"><span class="nav-number">7.1.</span> <span class="nav-text">str 和 repr</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cmp"><span class="nav-number">7.2.</span> <span class="nav-text">cmp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#len"><span class="nav-number">7.3.</span> <span class="nav-text">len</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数学运算"><span class="nav-number">7.4.</span> <span class="nav-text">数学运算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#类型转换"><span class="nav-number">7.5.</span> <span class="nav-text">类型转换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#property"><span class="nav-number">7.6.</span> <span class="nav-text">@property</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#slots"><span class="nav-number">7.7.</span> <span class="nav-text">slots</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#call"><span class="nav-number">7.8.</span> <span class="nav-text">call</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">NingAnMe</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
